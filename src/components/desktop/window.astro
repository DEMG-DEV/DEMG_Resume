---
interface Props {
  id: string;
  title: string;
  initialX?: string;
  initialY?: string;
  width?: string;
  height?: string;
  isOpen?: boolean;
}

const { id, title, initialX = "100px", initialY = "100px", width = "800px", height = "600px", isOpen = false } = Astro.props;
---

<div id={id} 
     class={`desktop-window fixed flex flex-col rounded-xl shadow-2xl transition-opacity duration-200 ${isOpen ? 'opacity-100 scale-100 pointer-events-auto' : 'opacity-0 scale-95 pointer-events-none'}`}
     style={`width: ${width}; height: ${height}; top: ${initialY}; left: ${initialX}; z-index: 10;`}
     onmousedown={`window.desktop.bringToFront('${id}')`}>
    
    <!-- Window Header / Toolbar -->
    <div class="window-header h-10 w-full rounded-t-xl bg-white/80 backdrop-blur-md border-b border-gray-200 flex items-center px-4 cursor-default select-none">
        <!-- Traffic Lights -->
        <div class="flex items-center gap-2 mr-4 group">
            <button onclick={`window.desktop.closeWindow('${id}')`} class="w-3 h-3 rounded-full bg-red-500 hover:bg-red-600 flex items-center justify-center shadow-sm">
                 <svg class="w-2 h-2 text-red-900 opacity-0 group-hover:opacity-100 font-bold" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="4" d="M6 18L18 6M6 6l12 12"></path></svg>
            </button>
            <button class="w-3 h-3 rounded-full bg-yellow-500 hover:bg-yellow-600 flex items-center justify-center shadow-sm">
                <svg class="w-2 h-2 text-yellow-900 opacity-0 group-hover:opacity-100 font-bold" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="4" d="M20 12H4"></path></svg>
            </button>
            <button onclick={`window.desktop.maximizeWindow('${id}')`} class="w-3 h-3 rounded-full bg-green-500 hover:bg-green-600 flex items-center justify-center shadow-sm">
                 <svg class="w-2 h-2 text-green-900 opacity-0 group-hover:opacity-100 font-bold" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="4" d="M8 3v3a2 2 0 01-2 2H3m18 0h-3a2 2 0 01-2-2V3m0 18v-3a2 2 0 012-2h3M3 16h3a2 2 0 012 2v3"></path></svg>
            </button>
        </div>
        
        <!-- Window Title -->
        <div class="flex-1 text-center font-medium text-gray-700 text-sm tracking-wide">{title}</div>
        
        <!-- Spacer (to center title properly) -->
        <div class="w-14"></div>
    </div>

    <!-- Window Content -->
    <div class="flex-1 overflow-auto bg-white/60 backdrop-blur-lg rounded-b-xl relative">
        <slot />
    </div>
</div>

<style>
    .desktop-window {
        box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        border: 1px solid rgba(255, 255, 255, 0.4);
    }
    .window-header {
        background: linear-gradient(to bottom, rgba(235, 235, 235, 0.95), rgba(220, 220, 220, 0.8));
    }
</style>
